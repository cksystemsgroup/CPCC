<html t:type="layout" title="Real Vehicle Configuration"
	xmlns:t="http://tapestry.apache.org/schema/tapestry_5_3.xsd"
	xmlns:p="tapestry:parameter">

<br />
<t:form t:id="uriForm">
	<div class="row">
		<t:errors />
		<fieldset>
			<div class="span2">
				<label>${message:masterURI}</label>
			</div>
			<div class="span4">
				<input t:type="TextField" t:id="masterServerUri"
					value="masterServerURI.value" t:validate="maxlength=100" size="30"
					onchange="this.form.submit();" />
			</div>
		</fieldset>
	</div>
</t:form>

<t:form t:id="coreForm">
	<div class="row">
		<t:errors />
		<div class="span2">${message:useInternalRosCore}</div>
		<div class="span4">
			<t:checkbox t:id="internalRosCore" value="internalRosCore.value"
				onclick="this.form.submit();" />
		</div>
	</div>
</t:form>

<section id="buttons">
	<a t:type="pagelink" page="ros/newDevice" href="#"
		class="btn btn-primary">${message:createNewDevice}</a>
</section>

<section id="deviceList">
	<h3>${message:deviceList}</h3>
	<table t:type="grid" source="deviceList" exclude="builtin,id,label,parentLabel,uniqueId,leaf"
		add="typeName,affiliation,editDeviceActions"
		reorder="topicRoot,affiliation,typeName,configuration,editDeviceActions"
		row="deviceConfig"
		class="table table-striped table-condensed topic-table">

		<p:affiliationCell>
			<t:if test="deviceConfig.type.className">
				${message:internalMapping}
				<p:else>
					${message:externalMapping}
				</p:else>
			</t:if>
		</p:affiliationCell>

		<p:typeNameCell>${deviceConfig.Type.Name}</p:typeNameCell>

		<p:editDeviceActionsCell>
			<a t:type="pagelink" page="ros/editDevice"
				context="deviceConfig.topicRoot" href="#"
				title="${message:editDevice}"> <i class="icon-pencil"></i>
			</a>
			&nbsp;
			<a t:type="eventlink" event="deleteDevice"
				context="deviceConfig.topicRoot" href="#"
				title="${message:deleteDevice}"> <i class="icon-remove"></i>
			</a>
		</p:editDeviceActionsCell>

		<p:empty>
			<p>${message:noDeviceFound}</p>
		</p:empty>
	</table>
</section>

<section id="mappingList">
	<h3>${message:mappingList}</h3>
	<t:form t:id="mappingForm">
		<table t:type="grid" source="mappingList"
			exclude="device,topic,vvVisible,primaryCategory,connectedToAutopilot"
			add="topicPath,vvVisibleCb,typeName,category,autoPilotCb"
			reorder="topicPath,vvVisibleCb,typeName,category,autoPilotCb" row="mappingConfig"
			class="table table-striped table-condensed topic-table">

			<p:vvVisibleCbCell>
				<t:checkbox t:id="vvVisibleCB" value="mappingConfig.vvVisible"
					onclick="this.form.submit();" />
			</p:vvVisibleCbCell>
			
			<p:autoPilotCbCell>
				<t:if test="mappingConfig.connectedToAutopilot">
					<t:if test="mappingConfig.pk.topic.subpath">
						<a t:type="eventlink" event="disconnectFromAutoPilot"
							context="${mappingConfig.pk.device.topicRoot}/${mappingConfig.pk.topic.subpath}" href="#"
							title="${message:connectedToAutoPilot}"> <i class="icon-plane"></i></a>
						<p:else>
							<a t:type="eventlink" event="disconnectFromAutoPilot"
								context="${mappingConfig.pk.device.topicRoot}" href="#"
								title="${message:connectedToAutoPilot}"> <i class="icon-plane"></i></a>						
						</p:else>
					</t:if>
				<p:else>
					<t:if test="mappingConfig.pk.topic.subpath">
						<a t:type="eventlink" event="connectToAutoPilot"
							context="${mappingConfig.pk.device.topicRoot}/${mappingConfig.pk.topic.subpath}" href="#"
							title="${message:connectToAutoPilot}"> <i class="icon-plus"></i></a>
						<p:else>
							<a t:type="eventlink" event="connectToAutoPilot"
								context="${mappingConfig.pk.device.topicRoot}" href="#"
								title="${message:connectToAutoPilot}"> <i class="icon-plus"></i></a>						
						</p:else>
					</t:if>
				</p:else>
			</t:if>
			
			</p:autoPilotCbCell>

			<p:topicPathCell>
				${mappingConfig.pk.device.topicRoot}<t:if
					test="mappingConfig.pk.topic.subpath">/${mappingConfig.pk.topic.subpath}</t:if>
			</p:topicPathCell>

			<p:typeNameCell>
				${mappingConfig.pk.topic.messageType}
			</p:typeNameCell>

			<p:categoryCell>
				${mappingConfig.pk.topic.category}
			</p:categoryCell>
		
			<p:empty>
				<p>${message:noMappingFound}</p>
			</p:empty>
		</table>
	</t:form>
</section>

<!-- <section id="realVehicle"> -->
<!-- 	<h3>${message:realVehicleConfiguration}</h3> -->
<!-- 	<table t:type="grid" source="mappingList" -->
<!-- 		exclude="device,topic,vvVisible,primaryCategory" -->
<!-- 		add="topicPath,typeName,category" reorder="topicPath,typeName" -->
<!-- 		row="mappingConfig" -->
<!-- 		class="table table-striped table-condensed topic-table"> -->

<!-- 		<p:topicPathCell> -->
<!-- 			${mappingConfig.pk.device.topicRoot}<t:if -->
<!-- 				test="mappingConfig.pk.topic.subpath">/${mappingConfig.pk.topic.subpath}</t:if> -->
<!-- 		</p:topicPathCell> -->

<!-- 		<p:typeNameCell> -->
<!-- 				${mappingConfig.pk.topic.messageType} -->
<!-- 		</p:typeNameCell> -->

<!-- 		<p:categoryCell> -->
<!-- 				${mappingConfig.pk.topic.category} -->
<!-- 		</p:categoryCell> -->
		
<!-- 		<p:empty> -->
<!-- 			<p>${message:noMappingFound}</p> -->
<!-- 		</p:empty> -->

<!-- 	</table> -->

<!-- </section> -->


</html>
